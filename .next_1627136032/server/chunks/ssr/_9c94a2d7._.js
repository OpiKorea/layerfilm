module.exports=[48740,a=>{"use strict";function b(a){let b=a.ideas||a,c=b.author||{},d=b.metrics?.metadata||{};return{id:b.id,title:b.title,description:b.description,type:b.type||d.type||"video",genre:b.genre||d.genre||"Sci-Fi",runtime:b.runtime||d.runtime||"00:00",ai_tool:b.ai_tool||d.ai_tool||"Unknown",privateContent:b.private_content||d.private_content,videoUrl:b.video_url||b.preview_url||b.private_content||d.video_url||"https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",thumbnailUrl:b.thumbnail_url||b.preview_url||d.thumbnail_url||"",title_ko:b.title_ko||d.title_ko,description_ko:b.description_ko||d.description_ko,status:b.status||d.status||"pending",author_id:b.author_id,author:{name:c.username||"Anonymous",avatar:c.avatar_url||"",role:c.role||"assistant"},price:b.price,metrics:{views:b.view_count||b.metrics?.views||0,likes:b.like_count||b.metrics?.likes||0},created_at:b.created_at||new Date().toISOString()}}a.s(["mapRowToIdea",()=>b])},72135,a=>{"use strict";var b=a.i(37936),c=a.i(22176),d=a.i(18558),e=a.i(48740),f=a.i(13095);let g=["/","/explore","/dashboard","/admin","/library","/mylist"];async function h(){g.forEach(a=>(0,d.revalidatePath)(a))}async function i(a,b){let d=await (0,c.createClient)(),{data:f,error:g}=await d.from("ideas").update({status:b}).eq("id",a).select().single();if(g&&("42703"===g.code||g.message.toLowerCase().includes("column"))){console.warn("[Data] Falling back to metrics metadata for status update");let{data:c}=await d.from("ideas").select("metrics").eq("id",a).single(),e=c?.metrics||{views:0,likes:0},h={...e,metadata:{...e.metadata||{},status:b}};({data:f,error:g}=await d.from("ideas").update({metrics:h}).eq("id",a).select().single())}return g?(console.error("[Data] updateIdeaStatus failed:",g.message),null):(h(),(0,e.mapRowToIdea)(f))}async function j(a){let b=await (0,c.createClient)();console.log(`[Data] Creating new idea: ${a.title}`);let d={title:a.title,description:a.description,type:"video",price:0,author_id:a.author_id,private_content:a.video_url,preview_url:a.video_url},f={...d,video_url:a.video_url,thumbnail_url:a.thumbnail_url,genre:a.genre,status:"pending",title_ko:a.title_ko,description_ko:a.description_ko},{data:g,error:i}=await b.from("ideas").insert(f).select().single();if(i&&("42703"===i.code||i.message.includes("column"))){console.warn("[Data] Falling back to metrics metadata for insertion");let c={...d,metrics:{views:0,likes:0,metadata:{video_url:a.video_url,thumbnail_url:a.thumbnail_url,genre:a.genre,status:"pending",title_ko:a.title_ko,description_ko:a.description_ko}}};({data:g,error:i}=await b.from("ideas").insert(c).select().single())}return i?(console.error("[Data] createIdea failed:",i.message),{success:!1,error:i.message}):(h(),{success:!0,data:(0,e.mapRowToIdea)(g)})}async function k(a){let b=await (0,c.createClient)(),{data:d,error:f}=await b.from("ideas").select("*, author:author_id(username, avatar_url, role)").eq("author_id",a).order("created_at",{ascending:!1});return f?(console.error("[Data] getUserSubmissions failed:",f.message),[]):(d||[]).map(e.mapRowToIdea)}async function l(a,b,d,f,g=!1,h="latest"){let i=await (0,c.createClient)(),j=i.from("ideas").select("*, author:author_id!inner(username, avatar_url, role)");try{j=g?j.or("status.in.(pending,reported),metrics->metadata->status.in.(pending,reported)"):j.or("status.eq.approved,metrics->metadata->status.eq.approved"),d&&(j=j.eq("author.role",d)),f&&(j=j.eq("type",f)),b&&"All"!==b&&(j=j.ilike("genre",`%${b}%`)),a&&(j=j.ilike("title",`%${a}%`)),j="trending"===h?j.order("view_count",{ascending:!1}):j.order("created_at",{ascending:!1});let{data:c,error:k}=await j;if(k&&("42703"===k.code||k.message.toLowerCase().includes("column"))){let a=i.from("ideas").select("*, author:author_id!inner(username, avatar_url, role)");d&&(a=a.eq("author.role",d)),f&&(a=a.eq("type",f)),a="trending"===h?a.order("view_count",{ascending:!1}):a.order("created_at",{ascending:!1});let b=await a;c=b.data,k=b.error}if(k)return console.error("[Data] getIdeas main query failed:",k.message),[];let l=(c||[]).map(e.mapRowToIdea),m=g?l.filter(a=>["pending","reported"].includes(a.status)):l.filter(a=>"approved"===a.status);if(b&&"All"!==b){let a=b.toLowerCase();m=m.filter(b=>b.genre?.toLowerCase().includes(a))}if(a){let b=a.toLowerCase();m=m.filter(a=>a.title.toLowerCase().includes(b)||a.description.toLowerCase().includes(b))}return m}catch(a){return console.error("[Data] getIdeas exception:",a.message),[]}}async function m(a){let b=await (0,c.createClient)(),{data:d,error:f}=await b.from("ideas").select("*, author:author_id(username, avatar_url, role)").eq("id",a).single();return f?void console.error(`[Data] getIdeaById(${a}) failed:`,f.message):(0,e.mapRowToIdea)(d)}async function n(a){let b=await (0,c.createClient)(),{data:d,error:f}=await b.from("purchases").select("ideas (*, author:author_id(username, avatar_url, role))").eq("user_id",a);return f?(console.error("[Data] getPurchasedIdeas failed:",f.message),[]):(d||[]).map(a=>(0,e.mapRowToIdea)(a.ideas)).filter(a=>a.id)}async function o(a){let b=await (0,c.createClient)(),{data:d,error:e}=await b.from("comments").select("*, user:user_id(username, avatar_url)").eq("idea_id",a).order("created_at",{ascending:!1});return e?(console.error("[Data] getComments failed:",e.message),[]):d||[]}async function p(a,b){let d=await (0,c.createClient)(),f={};b.title&&(f.title=b.title);let{data:g,error:h}=await d.from("ideas").update(f).eq("id",a).select("*, author:author_id(username, avatar_url, role)").single();return h?(console.error("[Data] updateMockIdea failed:",h.message),null):(0,e.mapRowToIdea)(g)}async function q(a,b,e,f){let g=await (0,c.createClient)(),{data:i,error:j}=await g.from("comments").insert({idea_id:a,user_id:b,content:e,rating:f}).select("*, user:user_id(username, avatar_url)").single();return j?(console.error("[Data] postComment failed:",j.message,j.details),null):((0,d.revalidatePath)(`/idea/${a}`),h(),i)}async function r(a,b){let e=await (0,c.createClient)(),{error:f}=await e.from("comments").delete().eq("id",a);return f?console.error("[Data] deleteComment failed:",f.message):(0,d.revalidatePath)(`/idea/${b}`),{success:!f,error:f?.message}}async function s(a){let b=await (0,c.createClient)();await b.from("comments").delete().eq("idea_id",a),await b.from("favorites").delete().eq("idea_id",a);let{error:d}=await b.from("ideas").delete().eq("id",a);return d?console.error("[Data] deleteIdea failed:",d.message):h(),{success:!d,error:d?.message}}async function t(a){let b=await (0,c.createClient)(),{error:d}=await b.from("ideas").update({status:"reported"}).eq("id",a);if(d&&("42703"===d.code||d.message.toLowerCase().includes("column"))){console.warn("[Data] Falling back to metrics metadata for reporting");let{data:c}=await b.from("ideas").select("metrics").eq("id",a).single(),e=c?.metrics||{views:0,likes:0},f={...e,metadata:{...e.metadata||{},status:"reported"}};d=(await b.from("ideas").update({metrics:f}).eq("id",a)).error}return d?console.error("[Data] reportIdea failed:",d.message):h(),{success:!d,error:d?.message}}(0,f.ensureServerEntryExports)([i,j,k,l,m,n,o,p,q,r,s,t]),(0,b.registerServerReference)(i,"60e92f3455bb82d7c2304362edb9c824836ae7ed03",null),(0,b.registerServerReference)(j,"407db7302c362dbff6dedf3aca1e2d5113a5409193",null),(0,b.registerServerReference)(k,"40f5046c312427400fefa0543e5409127993dc5dc7",null),(0,b.registerServerReference)(l,"7e034176b4a5cfb48c87e845d8e4a239f0f6398c67",null),(0,b.registerServerReference)(m,"407301460afae7a70096407292b4106c1de03c827c",null),(0,b.registerServerReference)(n,"40c12388d16e149c2e6e2e80707ce000606813e74e",null),(0,b.registerServerReference)(o,"402c31f4765968f5f0deed4701bfcf16fde9cd9496",null),(0,b.registerServerReference)(p,"608dc83b93f30afdad54121a38b6d5a7133b242287",null),(0,b.registerServerReference)(q,"780378d54c33e28c6cfaff1408640a1e8e924458d8",null),(0,b.registerServerReference)(r,"6098172a6239d3b441f9b0e6a034c0e410277e8abf",null),(0,b.registerServerReference)(s,"40893ab73075292817244e54ac8aa221fe0ddfa62d",null),(0,b.registerServerReference)(t,"4099434bcccc7f11be2d0a4a89041dadbf5b0515db",null),a.s(["createIdea",()=>j,"deleteComment",()=>r,"deleteIdea",()=>s,"getComments",()=>o,"getIdeaById",()=>m,"getIdeas",()=>l,"getPurchasedIdeas",()=>n,"getUserSubmissions",()=>k,"postComment",()=>q,"reportIdea",()=>t,"updateIdeaStatus",()=>i,"updateMockIdea",()=>p])},41088,a=>{"use strict";var b=a.i(37936),c=a.i(72135);async function d(a){return await (0,c.getIdeas)(a)}(0,a.i(13095).ensureServerEntryExports)([d]),(0,b.registerServerReference)(d,"404684603589b3eda7fbdf5e6a4959ba010ef2ddf9",null),a.s(["getIdeas",()=>d])},19799,a=>{"use strict";var b=a.i(19789),c=a.i(41088);a.s([],59554),a.i(59554),a.s(["001a12759ed3595f516c5960dce642e4ab94c950e9",()=>b.deleteAccount,"004fd2fb25930ef7068181c897f9f2797c80582cc6",()=>b.signOut,"40259a322631d80d69ac3bce45034934ba38258e12",()=>b.updatePassword,"4038e9669a98ad5b47901869646898a960fe0265b4",()=>b.resendOtp,"404684603589b3eda7fbdf5e6a4959ba010ef2ddf9",()=>c.getIdeas,"4090ecd0e8a8605b1dc0fdcf5446aa5028bcde6473",()=>b.changePassword,"40a5307c9d000b9ed4394b02271c85f96ad2fb79b1",()=>b.requestPasswordReset,"40bd5965d6f2e5c1bcc3d42526c301f9e318f45ce6",()=>b.login,"40d2019f451ebf52eea865f59e2e21e978a2fccf5b",()=>b.testResend,"40d4ff4158eb5b3706ed21bf6e8afe1864eea62cc7",()=>b.signup,"40e8ae682e855277b08c4bdb29f2d3e00ff41bccba",()=>b.completeSignupWithOtp,"6034c7323fb16f49e92f0f4562c69163545f52f082",()=>b.verifyEmailOtp,"6056444eb6d09ac9551541132d002b43a29d5254b8",()=>b.sendSignupOtp],19799)}];

//# sourceMappingURL=_9c94a2d7._.js.map